/*! jquery-cloneya 2015-03-02 */
!function(a){var b=function(b,c){var d=/^(.*)(\d)+$/i,e=a(b),f={limit:999,cloneThis:".toclone",valueClone:!1,dataClone:!1,deepClone:!1,cloneButton:".clone",deleteButton:".delete",clonePosition:"after",serializeID:!0,ignore:"label.error",defaultRender:!1,preserveChildCount:!1},g=a.extend(f,c||{});this.getOption=function(){return g},this.setOption=function(b){a.extend(g,b||{})},e.find(g.cloneThis).addClass("cloneya"),a.extend(g,{childCount:e.find(g.cloneThis).length}),e.find(g.cloneButton).length&&e.on("click",g.cloneButton,function(b){b.preventDefault(),e.triggerHandler("clone_clone",[a(this)])}),e.on("clone_clone",function(b,c){$toclone=c.closest(g.cloneThis);var d=$toclone.siblings().add($toclone).length;if(d<g.limit){if(e.triggerHandler("clone_before_clone",[$toclone]),$newclone=$toclone.clone({withDataAndEvents:g.dataClone,deepWithDataAndEvents:g.deepClone}),"false"!==g.preserveChildCount){var f=$newclone.find(".cloneya"),i=f.slice(g.childCount,f.length);i.remove()}$newclone.find("input, textarea, select").each(function(){h(a(this)),e.triggerHandler("clone_form_input",[a(this),$toclone,$newclone])}),e.triggerHandler("clone_after_clone",[$toclone,$newclone]),e.triggerHandler("clone_before_append",[$toclone,$newclone]),"after"!==g.clonePosition?$toclone.before($newclone):$toclone.after($newclone),g.ignore&&$newclone.find(g.ignore).remove(),k(),e.triggerHandler("clone_after_append",[$toclone,$newclone])}else e.triggerHandler("clone_limit",g.limit,[$toclone])}),e.find(g.cloneButton).length&&e.on("click",g.deleteButton,function(b){b.preventDefault(),e.triggerHandler("clone_delete",[a(this)])}),e.on("clone_delete",function(b,c){$todelete=c.closest(g.cloneThis);var d=$todelete.siblings().add($todelete).length;a.when(e.triggerHandler("clone_before_delete",[$todelete,d])).done(function(){e.triggerHandler("clone_after_delete")})}),e.on("clone_before_delete",function(b,c,d){d>1?a(c).remove():c.find("input, textarea, select").each(function(){h(a(this))})});var h=function(a){g.valueClone||a.hasClass("noEmpty")||(a.is(":checkbox")||a.is(":radio")?a.prop("checked",!1):a.val(""))},k=function(){g.serializeID===!0&&(mainid=e.find(g.cloneThis).first().attr("id"),e.find(g.cloneThis).each(function(b){j=0!==b?b:"",a(this).attr("id")&&a(this).attr("id",mainid+j);var c,e;a(this).find("*").each(function(){if(c=a(this).attr("id")){var f=c.match(d);f&&3===f.length?(e=c.replace(/\d+$/,"")+j,a(this).attr("id",e)):(e=c+j,a(this).attr("id",e))}a(this).closest(g.cloneThis).find("label[for='"+c+"']").attr("for",e);var h=a(this).attr("name");if(h){var i=h.match(/\[([^}]+)\]/);if(i&&i.length>=1){var k=h;h=[].map.call(k,function(a,c){return isNaN(+a)||"["!==k[c-1]||"]"!==k[c+1]?a:b}).join(""),a(this).attr("name",h)}}})}))};if(g.defaultRender)for(i=1;i<g.defaultRender;i++)a(g.cloneButton).last().trigger("click")};a.fn.cloneya=function(c){return this.each(function(){var d=a(this);if(!d.data("cloneya")){var e=new b(this,c);d.data("cloneya",e)}})}}(jQuery);